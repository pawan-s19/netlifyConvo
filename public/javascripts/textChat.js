var socket=io(),connected=!1,room="",typingdiv=document.querySelector(".typing"),flash=document.querySelector(".typing small");let ctn=document.querySelector(".msgCtn");var endbtn=document.querySelectorAll("#end"),selbtn=document.querySelector("#sel"),txt=document.querySelector("textarea"),audio=new Audio("/media/messageArrived.mp3"),joinedAudio=new Audio("/media/joined.mp3"),leftAudio=new Audio("/media/left.mp3"),istyping=!1,timeout=void 0;socket.emit("inTextChat");let getTime=()=>{const e=new Date;let t=e.getHours(),n=e.getMinutes();n=n>=0&&n<10?`0${n}`:n;let o=t>=12?"pm":"am";return t=t%12||12,t=12===t||11===t||10===t?t:`0${t}`,{hour:t,minutes:n,ampm:o}};function scrollToTop(){ctn.scrollTop=ctn.scrollHeight}function typingTimeout(){istyping=!1,socket.emit("typing",{istyping:istyping})}let flag=e=>{endbtn.forEach((t=>{t.style.pointerEvents=e?"none":"auto"}))};var app=function(){var e=void 0,t=void 0,n=function(){t.addEventListener("click",(function(){return o(e,"nav-active")}))},o=function(e,t){e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)};e=document.querySelector("body"),t=document.querySelector(".menu-icon"),document.querySelectorAll(".nav__list-item"),n()};function msgSender(e){""!==e.trim()?(socket.emit("message",{msgs:e,time:getTime()}),txt.value="",clearTimeout(timeout),typingTimeout()):txt.value=""}app(),document.querySelector("#send").addEventListener("click",(function(){msgSender(txt.value)})),txt.addEventListener("keyup",(e=>{13===e.keyCode&&msgSender(txt.value)})),txt.addEventListener("keypress",(function(e){13!==e.keyCode&&(istyping=!0,clearTimeout(timeout),timeout=setTimeout(typingTimeout,1e3),socket.emit("typing",{istyping:istyping}))})),socket.on("display",(function(e){!0===e.istyping?(flash.textContent="Stranger is typing",typingdiv.style.display="flex"):(flash.textContent="",typingdiv.style.display="none")})),socket.on("connect",(function(){connected=!0,socket.emit("userConnected")})),socket.on("chatStart",(e=>{ctn.innerHTML=`<h6>${e.msg}</h6>`,joinedAudio.play(),e.msg&&(txt.disabled=!1,flag(!1),txt.focus())}));var count=0,count2=0;socket.on("reply",(function(e){e.id===socket.id?(count2=0,0===count?(document.querySelector(".msgCtn").innerHTML+=`<div class="msgWrapper aRight">\n          <h6>You, ${e.data.time.hour}:${e.data.time.minutes} ${e.data.time.ampm}</h6>\n          <div class="textHolder">\n              <div class="triR"></div>\n              <h3>${e.data.msgs}</h3>\n          </div>\n        </div>`,count++):document.querySelector(".msgCtn").innerHTML+=`<div class="msgWrapper aRight">\n        <div class="textHolder">\n            <div class="triR"></div>\n            <h3>${e.data.msgs}</h3>\n        </div>\n      </div>`):(count=0,audio.play(),0===count2?(document.querySelector(".msgCtn").innerHTML+=`<div class="msgWrapper">\n          <h6>Stranger, ${e.data.time.hour}:${e.data.time.minutes} ${e.data.time.ampm}</h6>\n          <div class="textHolder">\n              <div class="triL"></div>\n              <h3>${e.data.msgs}</h3>\n          </div>\n        </div>`,count2++):document.querySelector(".msgCtn").innerHTML+=`<div class="msgWrapper">\n          <div class="textHolder">\n              <div class="triL"></div>\n              <h3>${e.data.msgs}</h3>\n          </div>\n        </div>`),setTimeout((()=>{ctn.lastChild.style.transform="scale(1)"}),0),scrollToTop()})),socket.on("roomName",(e=>{room=e})),socket.on("chatEnd",(e=>{typingdiv.style.display="none",txt.disabled=!0,flag(!0),e.msg&&(leftAudio.play(),ctn.innerHTML+="<h6>Stranger Disconnected</h6><h5>Waiting for Someone to Connect...</h5>",scrollToTop()),room=""})),endbtn.forEach((e=>{e.addEventListener("click",(()=>{typingdiv.style.display="none",leave_chat(),ctn.innerHTML+="<h6>You Disconnected</h6><h5>Waiting for Someone to Connect...</h5>",scrollToTop()}))}));var leave_chat=function(){connected&&(socket.emit("leaveRoom"),txt.disabled=!0,flag(!0),room="")};function selectText(e){var t=document.querySelector(`.${e}`);if(document.selection)(n=document.body.createTextRange()).moveToElementText(t),n.select();else if(window.getSelection){var n;(n=document.createRange()).selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}count=0,count2=0}selbtn.addEventListener("click",(()=>{selectText("msgCtn")})),window.addEventListener("resize",(()=>{scrollToTop()}));const getDeviceType=()=>{const e=navigator.userAgent;return console.log(window.navigator),/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?(txt.addEventListener("keyup",(()=>{istyping=!0,clearTimeout(timeout),timeout=setTimeout(typingTimeout,1e3),socket.emit("typing",{istyping:istyping})})),"mobile"):"desktop"};getDeviceType();let outlinetxt=document.querySelectorAll(".msgCtn h5 span"),i=0;setInterval((()=>{i<4?(outlinetxt[i].classList.remove("outlined"),outlinetxt[i+1].classList.add("outlined"),i++):(outlinetxt[i].classList.remove("outlined"),outlinetxt[0].classList.add("outlined"),i=0)}),448),gsap.from("#room",{duration:1,opacity:0,rotate:90,ease:"power1.inOut",y:"200px"}),gsap.from("#vid",{duration:1,opacity:0,rotate:90,ease:"power1.inOut",y:"100px"}),gsap.from(".txt1",{duration:1,opacity:0,rotate:90,ease:"power1.inOut",y:"-100px"}),gsap.from(".txt2",{duration:1,opacity:0,rotate:90,ease:"power1.inOut",y:"-200px"}),gsap.from(".logo",{duration:1,opacity:0,x:"-100%",ease:"power4.inOut"}),gsap.from(".label",{duration:1,opacity:0,x:"100%",ease:"power4.inOut"}),gsap.from(".msgCtn h5",{duration:1,opacity:0,y:"-100%",ease:"power3.inOut"});